{% extends "base_simple.html" %}

{% block title %}Link Generated{% endblock %}

{% block extra_css %}
<style>
.instagram-success-container {
    max-width: 450px;
    margin: 0 auto;
    background: #fff;
    border: 1px solid #dbdbdb;
    border-radius: 1px;
    overflow: hidden;
}

.success-header {
    text-align: center;
    padding: 40px 20px 20px;
    background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);
    color: white;
}

.success-icon {
    font-size: 3rem;
    margin-bottom: 16px;
    color: white;
}

.success-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
    color: white;
}

.success-subtitle {
    font-size: 14px;
    opacity: 0.9;
    color: white;
}

.link-preview {
    margin: 20px;
    background: #fafafa;
    border: 1px solid #dbdbdb;
    border-radius: 8px;
    overflow: hidden;
}

.link-preview-header {
    background: #fff;
    padding: 12px 16px;
    border-bottom: 1px solid #dbdbdb;
    display: flex;
    align-items: center;
}

.link-preview-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584, #e1306c, #fd1d1d);
    margin-right: 12px;
}

.link-preview-username {
    font-weight: 600;
    font-size: 14px;
    color: #262626;
}

.link-preview-content {
    padding: 16px;
    text-align: left;
}

.link-url {
    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 14px;
    color: #00376b;
    background: #fff;
    padding: 8px 12px;
    border: 1px solid #dbdbdb;
    border-radius: 4px;
    word-break: break-all;
    margin-bottom: 12px;
}

.action-buttons {
    margin: 0 20px 20px;
}

.btn-instagram-outline {
    border: 1px solid #dbdbdb;
    background: #fff;
    border-radius: 8px;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 600;
    color: #262626;
    text-decoration: none;
    display: inline-block;
    margin-right: 8px;
    transition: all 0.2s ease;
}

.btn-instagram-outline:hover {
    background: #fafafa;
    border-color: #8e8e8e;
    color: #262626;
    text-decoration: none;
}

.btn-instagram-primary {
    background: #0095f6;
    border: 1px solid #0095f6;
    border-radius: 8px;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 600;
    color: white;
    text-decoration: none;
    display: inline-block;
    transition: all 0.2s ease;
}

.btn-instagram-primary:hover {
    background: #1877f2;
    border-color: #1877f2;
    color: white;
    text-decoration: none;
}

.share-instructions {
    background: #fafafa;
    border: 1px solid #dbdbdb;
    border-radius: 1px;
    margin: 0 20px 20px;
    padding: 16px;
}

.instructions-title {
    font-size: 16px;
    font-weight: 600;
    color: #262626;
    margin-bottom: 12px;
}

.instructions-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.instructions-list li {
    font-size: 14px;
    color: #8e8e8e;
    margin-bottom: 6px;
    display: flex;
    align-items: flex-start;
}

.instructions-list li:last-child {
    margin-bottom: 0;
}

.instructions-icon {
    color: #0095f6;
    margin-right: 8px;
    margin-top: 2px;
    font-size: 12px;
}

.success-footer {
    background: #fafafa;
    border-top: 1px solid #dbdbdb;
    padding: 16px 20px;
    text-align: center;
    font-size: 12px;
    color: #8e8e8e;
}
</style>
{% endblock %}

{% block content %}
<div class="container min-vh-100 d-flex align-items-center justify-content-center">
    <div class="row w-100">
        <div class="col-12">
            <div class="instagram-success-container">
                <div class="success-header">
                    <i class="fas fa-check-circle success-icon"></i>
                    <div class="success-title">Link Generated Successfully!</div>
                    <div class="success-subtitle">Your secure message link is ready</div>
                </div>
                
                <div class="link-preview">
                    <div class="link-preview-header">
                        <div class="link-preview-avatar"></div>
                        <div>
                            <div class="link-preview-username">telegramlinker</div>
                            <div style="font-size: 12px; color: #8e8e8e;">just now</div>
                        </div>
                    </div>
                    <div class="link-preview-content">
                        <div class="link-url">{{ request.url_root[:-1] }}{{ link }}</div>
                        <p style="font-size: 14px; color: #8e8e8e; margin: 0;">
                            Share this secure link to receive messages via Telegram. One-time use only!
                        </p>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-instagram-primary" onclick="copyLink('{{ link }}')" id="copyBtn">
                        <i class="fas fa-copy me-1" id="copyIcon"></i>
                        <span id="copyText">Copy Link</span>
                    </button>
                    <button class="btn-instagram-outline" onclick="shareLink('{{ link }}')" id="shareBtn">
                        <i class="fas fa-share me-1"></i>
                        Share
                    </button>
                </div>
                
                <div class="share-instructions">
                    <div class="instructions-title">How to use:</div>
                    <ul class="instructions-list">
                        <li>
                            <i class="fas fa-check-circle instructions-icon"></i>
                            Copy the link above
                        </li>
                        <li>
                            <i class="fas fa-check-circle instructions-icon"></i>
                            Share it with anyone who needs to message you
                        </li>
                        <li>
                            <i class="fas fa-check-circle instructions-icon"></i>
                            Each recipient can use the link only once
                        </li>
                        <li>
                            <i class="fas fa-check-circle instructions-icon"></i>
                            Messages will be sent directly to your Telegram
                        </li>
                        <li>
                            <i class="fas fa-check-circle instructions-icon"></i>
                            Link expires in 24 hours or after first use
                        </li>
                    </ul>
                </div>
                
                <div class="success-footer">
                    <a href="{{ url_for('home') }}" class="btn-instagram-outline me-2">
                        <i class="fas fa-plus me-1"></i> Generate Another
                    </a>
                    <a href="{{ url_for('admin_dashboard') }}" class="btn-instagram-outline">
                        <i class="fas fa-chart-bar me-1"></i> Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function copyLink(link) {
    const fullUrl = window.location.origin + link;
    
    if (navigator.clipboard) {
        navigator.clipboard.writeText(fullUrl).then(function() {
            showCopySuccess();
        }).catch(function() {
            fallbackCopyText(fullUrl);
        });
    } else {
        fallbackCopyText(fullUrl);
    }
}

function fallbackCopyText(text) {
    const textArea = document.createElement("textarea");
    textArea.value = text;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    showCopySuccess();
}

function showCopySuccess() {
    const copyBtn = document.getElementById('copyBtn');
    const copyText = document.getElementById('copyText');
    const copyIcon = document.getElementById('copyIcon');
    
    copyText.textContent = 'Copied!';
    copyIcon.className = 'fas fa-check me-1';
    copyBtn.style.background = '#00d632';
    copyBtn.style.borderColor = '#00d632';
    
    setTimeout(function() {
        copyText.textContent = 'Copy Link';
        copyIcon.className = 'fas fa-copy me-1';
        copyBtn.style.background = '#0095f6';
        copyBtn.style.borderColor = '#0095f6';
    }, 2000);
}

function shareLink(link) {
    const fullUrl = window.location.origin + link;
    
    if (navigator.share) {
        navigator.share({
            title: 'Telegram Message Link',
            text: 'Use this secure link to send me a message via Telegram',
            url: fullUrl
        });
    } else {
        // Fallback: copy to clipboard
        copyLink(link);
        alert('Link copied to clipboard! You can now share it anywhere.');
    }
}
</script>
{% endblock %}